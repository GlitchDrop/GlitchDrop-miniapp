<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>GLITCH DROP ‚Äî Mini App</title>

  <style>
    :root{
      --bg-top:#0c1822; --bg-bot:#0e2230; --grid:rgba(255,255,255,.035); --grid-gap:34px;
      --panel:#0a0f1e; --panel2:#0a0d19; --card:#0e1330; --card2:#0b0f26;
      --neon-cyan:#16f1ff; --neon-pink:#ff3ed0; --neon-yellow:#ffe47a;
      --text:#e8efff; --muted:#9fb2d9; --border:rgba(120,180,255,.25);
      --shadow-strong:0 20px 60px rgba(10,20,60,.55), 0 0 60px rgba(22,241,255,.08);
      --shadow-soft:0 10px 30px rgba(10,20,60,.35);
      --radius:18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Inter',system-ui,Segoe UI,Roboto,Arial,sans-serif}
    html{scroll-behavior:smooth}
    body{ color:var(--text); overflow-x:hidden; background:#0e1b25; }
    .cyber-bg{
      position:fixed; inset:0; z-index:0; pointer-events:none;
      background:
        linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bot) 100%),
        repeating-linear-gradient(0deg,  var(--grid) 0 1px,  transparent 1px var(--grid-gap)),
        repeating-linear-gradient(90deg, var(--grid) 0 1px,  transparent 1px var(--grid-gap));
      background-blend-mode: normal, overlay, overlay;
    }

    .app{min-height:100%;display:flex;flex-direction:column;position:relative;z-index:1}

    .topbar{
      position:sticky; top:0; z-index:30;
      display:flex; align-items:center; gap:12px;
      padding:12px 14px;
      background:linear-gradient(180deg,rgba(8,14,36,.72),rgba(6,10,26,.62));
      border-bottom:1px solid var(--border);
      backdrop-filter:blur(10px);
      box-shadow:var(--shadow-soft);
    }
    .avatar{ width:42px; height:42px; border-radius:50%; border:2px solid rgba(22,241,255,.55); box-shadow:0 0 18px rgba(22,241,255,.28), 0 0 28px rgba(255,62,208,.18); object-fit:cover; background:linear-gradient(135deg, rgba(22,241,255,.15), rgba(255,62,208,.15)); }
    .avatar.hidden{ display:none; }
    .avatar-fallback{ width:42px; height:42px; border-radius:12px; display:grid; place-items:center; background:linear-gradient(135deg, rgba(22,241,255,.18), rgba(255,62,208,.18)); border:1px solid var(--border); font-weight:900; letter-spacing:.5px; color:#081121; text-shadow:0 0 12px rgba(22,241,255,.7); }
    .brand{position:relative; font-weight:900; line-height:1; letter-spacing:1px}
    .brand .glitch{ font-size:22px; color:#cfe6ff; position:relative; display:inline-block; text-shadow:0 0 24px rgba(22,241,255,.55), 0 0 24px rgba(255,62,208,.35); }
    .brand .glitch::before,.brand .glitch::after{ content:attr(data-text); position:absolute; left:0; top:0; width:100%; overflow:hidden; }
    .brand .glitch::before{ transform:translateX(1px); color:var(--neon-cyan); opacity:.9; text-shadow:0 0 10px rgba(22,241,255,.8); animation:glitch 3s infinite ease-in-out;}
    .brand .glitch::after { transform:translateX(-1px); color:var(--neon-pink); opacity:.8; text-shadow:0 0 10px rgba(255,62,208,.8); animation:glitch 2.6s infinite ease-in-out reverse;}
    @keyframes glitch{ 0%,100%{clip-path:inset(0 0 0 0)} 10%{clip-path:inset(0 0 65% 0)} 20%{clip-path:inset(0 0 0 0)} 30%{clip-path:inset(40% 0 0 0)} 45%{clip-path:inset(0 0 0 0)} 60%{clip-path:inset(0 0 75% 0)} 80%{clip-path:inset(20% 0 10% 0)} }
    .grow{flex:1}
    .pill{ display:flex; align-items:center; gap:10px; padding:8px 12px; border-radius:999px; border:1px solid var(--border); background:linear-gradient(135deg, rgba(22,241,255,.1), rgba(138,92,255,.12)); box-shadow:0 0 18px rgba(22,241,255,.12) inset; font-weight:900; color:#cfe6ff; }

    .chipbar{
      position:sticky; top:64px; z-index:25;
      display:flex; gap:10px; padding:10px 14px; overflow-x:auto;
      background:linear-gradient(180deg,rgba(8,14,36,.72),rgba(6,10,26,.62));
      border-bottom:1px solid var(--border);
      backdrop-filter:blur(10px);
    }
    .chipbar::-webkit-scrollbar{display:none}
    .chip{
      padding:10px 14px; border-radius:999px; white-space:nowrap; cursor:pointer;
      border:1px solid var(--border); color:var(--muted); font-weight:800; user-select:none;
      background:linear-gradient(135deg, rgba(15,20,48,.7), rgba(12,16,38,.7));
      transition:transform .15s, box-shadow .15s, color .15s, background .2s, border-color .2s;
    }
    .chip:hover{ transform:translateY(-1px); box-shadow:0 8px 22px rgba(22,241,255,.12)}
    .chip.active{ color:#081121 !important; background:linear-gradient(135deg, var(--neon-cyan), var(--neon-pink)) !important; border-color:transparent !important; box-shadow:0 6px 28px rgba(22,241,255,.35), 0 0 44px rgba(255,62,208,.25) !important; }

    .content{flex:1; padding:16px; max-width:1100px; margin:0 auto; width:100%}
    h2.section{ margin:20px 0 12px; text-align:center; font-size:13px; letter-spacing:2px; opacity:.95; color:#d7e6ff; text-shadow:0 0 16px rgba(22,241,255,.25); scroll-margin-top:130px; }
    .grid{display:grid; grid-template-columns:repeat(2,1fr); gap:14px}

    .card{ position:relative; background:linear-gradient(180deg, rgba(20,26,62,.55), rgba(14,18,40,.6)); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow-strong); padding:12px; display:flex; flex-direction:column; gap:10px; overflow:hidden; cursor:pointer; }
    .card::before{ content:""; position:absolute; inset:-2px; background:conic-gradient(from 200deg, transparent, rgba(22,241,255,.18), transparent 30%, rgba(255,62,208,.18), transparent 55%); filter:blur(14px); opacity:.35; z-index:0; }
    .inner{position:relative; z-index:1}
    .thumb{
      height:160px; border-radius:14px; border:1px dashed rgba(180,210,255,.35);
      background: radial-gradient(120px 80px at 20% 20%, rgba(22,241,255,.12), transparent 60%), radial-gradient(120px 80px at 80% 80%, rgba(255,62,208,.10), transparent 60%), linear-gradient(180deg,#0c1230,#0a1028);
      display:grid; place-items:center; color:#a9c2ff; font-size:12px; text-transform:uppercase; letter-spacing:1px;
      overflow:hidden;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }

    .name{font-weight:900; letter-spacing:.3px}
    .desc{font-size:12px; color:#9fb2d9}
    .price{font-weight:900; color:var(--neon-yellow); text-shadow:0 0 12px rgba(255,228,122,.25)}

    .tabbar{ position:sticky; bottom:0; z-index:24; background:linear-gradient(180deg,rgba(8,14,36,.72),rgba(6,10,26,.62)); border-top:1px solid var(--border); backdrop-filter:blur(10px); display:grid; grid-template-columns:repeat(5,1fr); padding:8px 6px }
    .tab{display:flex; flex-direction:column; align-items:center; gap:4px; padding:6px 2px; color:#9fb2d9; font-size:12px; font-weight:800}
    .tab.active{color:#e8efff}
    .ico{font-size:18px; text-shadow:0 0 10px rgba(22,241,255,.3)}

    .backtop{ position:fixed; right:14px; bottom:90px; z-index:50; padding:9px 12px; border-radius:12px; font-weight:900; font-size:12px; letter-spacing:.3px; border:1px solid rgba(22,241,255,.45); color:#081121; background:linear-gradient(135deg, var(--neon-cyan), var(--neon-pink)); box-shadow:0 10px 28px rgba(22,241,255,.35), 0 0 36px rgba(255,62,208,.25); opacity:0; pointer-events:none; transform:translateY(8px); transition:opacity .2s, transform .2s; }
    .backtop.show{opacity:1; pointer-events:auto; transform:translateY(0)}

    /* ====== DETAIL VIEW ====== */
    .detail{
      position:fixed; inset:0; z-index:60; display:none; flex-direction:column;
      background:
        linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bot) 100%),
        repeating-linear-gradient(0deg,  var(--grid) 0 1px,  transparent 1px var(--grid-gap)),
        repeating-linear-gradient(90deg, var(--grid) 0 1px,  transparent 1px var(--grid-gap));
      background-blend-mode: normal, overlay, overlay;
      overflow:auto;
    }
    .detail.show{ display:flex; }
    .d-topbar{ position:sticky; top:0; z-index:61; display:flex; align-items:center; gap:10px; padding:10px 14px; background:linear-gradient(180deg,rgba(8,14,36,.82),rgba(6,10,26,.7)); border-bottom:1px solid var(--border); backdrop-filter:blur(10px); }
    .btn-back{ appearance:none; border:1px solid var(--border); background:transparent; color:var(--text); padding:8px 12px; border-radius:12px; font-weight:900; cursor:pointer; }
    .d-title{font-weight:900}
    .d-body{padding:16px; max-width:1100px; margin:0 auto; width:100%}
    .d-hero{display:grid; grid-template-columns:1fr; gap:14px; margin-bottom:10px;}
    .d-thumb{ height:200px; border-radius:16px; border:1px dashed rgba(180,210,255,.35);
      background: radial-gradient(160px 110px at 20% 20%, rgba(22,241,255,.12), transparent 60%), radial-gradient(160px 110px at 80% 80%, rgba(255,62,208,.10), transparent 60%), linear-gradient(180deg,#0c1230,#0a1028);
      display:grid; place-items:center; color:#a9c2ff; text-transform:uppercase; letter-spacing:1px; }
    .d-actions{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    .btn-spin{ appearance:none; border:none; cursor:pointer; padding:12px 18px; border-radius:14px; font-weight:900; color:#081121; background:linear-gradient(135deg,#ffe28a,#ffc13a); box-shadow:0 10px 28px rgba(255,209,102,.35), 0 0 30px rgba(255,209,102,.25); }

    .panel{ margin-top:14px; padding:12px; border:1px solid var(--border); border-radius:16px; background:linear-gradient(180deg, rgba(20,26,62,.55), rgba(14,18,40,.6)); }
    .panel h3{margin:0 0 10px; text-align:center}
    .switch{display:flex; align-items:center; gap:10px; font-weight:800}
    .toggle{ width:46px; height:26px; border-radius:999px; position:relative; background:#2a314a; border:1px solid var(--border); cursor:pointer; }
    .toggle::after{ content:""; position:absolute; top:2px; left:2px; width:22px; height:22px; border-radius:50%; background:#fff; transition:transform .18s; }
    .toggle.active{ background:#19e6ff; } .toggle.active::after{ transform:translateX(20px); }
    .qty{display:flex; gap:10px; justify-content:center}
    .qty .q{ min-width:44px; height:40px; border-radius:12px; display:grid; place-items:center; cursor:pointer; border:1px solid var(--border); background:rgba(15,20,48,.6); font-weight:900; }
    .qty .q.active{ outline:2px solid var(--ne–æ–Ω-cyan); color:#081121; background:linear-gradient(135deg,var(--neon-cyan),var(--neon-pink)); border-color:transparent }

    .subhead{margin:18px 0 10px; text-align:center; font-weight:900; letter-spacing:1.2px}
    .loot-grid{display:grid; grid-template-columns:repeat(2,1fr); gap:12px}

    /* ===== –∫–∞—Ä—Ç–æ—á–∫–∏ –ª—É—Ç–∞ —Å–æ —Å–ª–æ—è–º–∏ ===== */
    .loot{
      position:relative;
      border-radius:14px;
      border:1px dashed rgba(180,210,255,.35);
      background: linear-gradient(180deg,#0c1230,#0a1028);
      display:block;
      width:100%;
      aspect-ratio:1/1;
      overflow:hidden;
      color:#a9c2ff; font-size:12px; text-transform:uppercase; letter-spacing:1px;
    }
    .loot img{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover; display:block;
      z-index:0;
    }
    .loot .meta{
      position:absolute; left:0; right:0; bottom:0;
      z-index:2;
      padding:10px 10px 12px;
      text-align:center; display:flex; flex-direction:column; gap:6px;
      background:linear-gradient(to top, rgba(6,10,26,.88) 0%, rgba(6,10,26,.65) 60%, rgba(6,10,26,0) 100%);
    }
    .loot .title{ font-weight:900; font-size:12px; line-height:1.2; color:#e8efff; text-shadow:0 0 8px rgba(22,241,255,.25); }

    /* ---- –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã –∏ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è —Ü–µ–Ω ---- */
    .loot .prices{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:2px;                  /* —Å—Ç—Ä–æ–∫–∏ –±–ª–∏–∂–µ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É */
    }
    .loot .price-row{
      display:flex;
      align-items:center;
      gap:4px;                  /* –∏–∫–æ–Ω–∫–∞ –±–ª–∏–∂–µ –∫ —á–∏—Å–ª–∞–º */
      font-weight:1000;         /* –∂–∏—Ä–Ω–µ–µ */
      font-size:18px;           /* –∫—Ä—É–ø–Ω–µ–µ —á–∏—Å–ª–∞ */
      line-height:1.05;         /* –ø–ª–æ—Ç–Ω–µ–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ */
      color:#e8efff;
    }
    .loot .price-row img{
      width:16px; height:16px;  /* –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ –∏–∫–æ–Ω–∫–∏ */
      object-fit:contain; display:block;
      transform:translateY(1px);/* –º–∏–∫—Ä–æ-–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –∫ –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–∏ */
      filter:drop-shadow(0 0 6px rgba(22,241,255,.25));
    }
  </style>
</head>
<body>
  <div class="cyber-bg"></div>

  <div class="app" id="top">
    <div class="topbar">
      <img id="userAvatar" class="avatar hidden" alt="avatar">
      <div id="avatarFallback" class="avatar-fallback">GD</div>
      <div class="brand"><span id="userName" class="glitch" data-text="GLITCH&nbsp;DROP">GLITCH&nbsp;DROP</span></div>
      <div class="grow"></div>
      <div class="pill"><span>‚≠ê</span><span class="num" id="stars">120</span></div>
    </div>

    <div class="chipbar" id="chipbar"><div class="chip active" data-target="#top">–í—Å–µ</div></div>
    <div class="content" id="content"></div>

    <nav class="tabbar">
      <div class="tab"><div class="ico">üèÜ</div>–ö–æ–Ω–∫—É—Ä—Å—ã</div>
      <div class="tab"><div class="ico">‚ö°</div>–ê–ø–≥—Ä–µ–π–¥</div>
      <div class="tab active"><div class="ico">üéÅ</div>–ö–µ–π—Å—ã</div>
      <div class="tab"><div class="ico">üë•</div>–î—Ä—É–∑—å—è</div>
      <div class="tab"><div class="ico">üë§</div>–ü—Ä–æ—Ñ–∏–ª—å</div>
    </nav>
  </div>

  <!-- DETAIL VIEW -->
  <div id="detail" class="detail" aria-hidden="true">
    <div class="d-topbar">
      <button id="backBtn" class="btn-back">‚Üê –ù–∞–∑–∞–¥</button>
      <div class="d-title" id="detailTitle">–ö–µ–π—Å</div>
      <div class="grow"></div>
    </div>
    <div class="d-body">
      <div class="d-hero">
        <div id="detailThumb" class="d-thumb">–ó–∞–≥–ª—É—à–∫–∞</div>
        <div class="d-actions">
          <button class="btn-spin">–ö–†–£–¢–ò–¢–¨</button>
          <div class="pill"><span>–¶–µ–Ω–∞:</span><span class="num" id="detailPrice">‚Äî</span></div>
        </div>
      </div>

      <div class="panel">
        <div class="switch" style="justify-content:space-between;margin-bottom:10px;">
          <span>–î–µ–º–æ —Ä–µ–∂–∏–º</span>
          <div id="demoToggle" class="toggle" role="switch" aria-checked="false"></div>
        </div>

        <h3>–°–∫–æ–ª—å–∫–æ –∫–µ–π—Å–æ–≤ –æ—Ç–∫—Ä—ã—Ç—å?</h3>
        <div class="qty" id="qtyWrap">
          <div class="q active" data-v="1">1</div><div class="q" data-v="2">2</div>
          <div class="q" data-v="3">3</div><div class="q" data-v="4">4</div>
          <div class="q" data-v="5">5</div>
        </div>
      </div>

      <div class="subhead">–°–û–î–ï–†–ñ–ò–ú–û–ï –ö–ï–ô–°–ê</div>
      <div id="lootGrid" class="loot-grid"></div>
      <div style="height:40px"></div>
    </div>
  </div>

  <button id="backTop" class="backtop" aria-label="–í–≤–µ—Ä—Ö">–í–í–ï–†–• ‚Üë</button>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    /* ===================== LOOT-–°–ï–¢–´ –ù–ê –í–°–ï –ö–ï–ô–°–´ (11 –°–°–´–õ–û–ö –í –ö–ê–ñ–î–û–ú) ===================== */
    const LOOT_SETS = {
      // –î–ï–®–Å–í–´–ï –ö–ï–ô–°–´
      cheap_1: [
        "assets/images/20251003_1635_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n4frmwe74ry17r7gszk6ef.png",
        "assets/images/20251003_1629_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n43z74eq3ve8a9rcx44f02.png",
        "assets/images/20251003_1627_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –§–æ–Ω_remix_01k6n416bkeassbn7rx8a17bdt.png",
        "assets/images/20251003_1626_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –§–æ–Ω_remix_01k6n3y428frhrwqy0rqfwq9n5.png",
        "assets/images/20251003_1624_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3v1nbffkrc39mm720d2gm.png",
        "assets/images/20251003_1622_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3re47eearqtkwjkzktpma.png",
        "assets/images/20251003_1632_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n49ebnfssrvwq0605g9bkx.png",
        "assets/images/20251003_1621_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3p2hwf4fbk1r0rqbvdc5d.png",
        "assets/images/20251003_1620_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3k7yrey7864fgc944j33p.png",
        "assets/images/20251003_1618_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3fv8bej7813hnthjyags5.png",
        "assets/images/20251003_1616_–°–µ—Ä–¥—Ü–µ —Å –±–∞–Ω—Ç–æ–º_remix_01k6n3czjze6paj61x9g5r7ab3.png"
      ],
      cheap_2: [
        "assets/images/—Å–Ω—É–ø–ø –¥–æ–≥.png",
        "assets/images/20251003_1635_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n4frmwe74ry17r7gszk6ef.png",
        "assets/images/20251003_1627_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –§–æ–Ω_remix_01k6n416bkeassbn7rx8a17bdt.png",
        "assets/images/20251003_1629_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n43z74eq3ve8a9rcx44f02.png",
        "assets/images/20251003_1626_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –§–æ–Ω_remix_01k6n3y428frhrwqy0rqfwq9n5.png",
        "assets/images/20251003_1632_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n49ebnfssrvwq0605g9bkx.png",
        "assets/images/20251003_1624_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3v1nbffkrc39mm720d2gm.png",
        "assets/images/20251003_1622_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3re47eearqtkwjkzktpma.png",
        "assets/images/20251003_1620_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3k7yrey7864fgc944j33p.png",
        "assets/images/20251003_1616_–°–µ—Ä–¥—Ü–µ —Å –±–∞–Ω—Ç–æ–º_remix_01k6n3czjze6paj61x9g5r7ab3.png",
        "assets/images/20251003_1618_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3fv8bej7813hnthjyags5.png"
      ],
      cheap_3: [
        "assets/images/kniga.png","assets/images/klever.png",
        "assets/images/20251003_1635_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n4frmwe74ry17r7gszk6ef.png",
        "assets/images/20251003_1627_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –§–æ–Ω_remix_01k6n416bkeassbn7rx8a17bdt.png",
        "assets/images/20251003_1629_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n43z74eq3ve8a9rcx44f02.png",
        "assets/images/20251003_1624_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3v1nbffkrc39mm720d2gm.png",
        "assets/images/20251003_1622_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3re47eearqtkwjkzktpma.png",
        "assets/images/20251003_1621_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3p2hwf4fbk1r0rqbvdc5d.png",
        "assets/images/20251003_1620_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3k7yrey7864fgc944j33p.png",
        "assets/images/20251003_1618_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3fv8bej7813hnthjyags5.png",
        "assets/images/20251003_1616_–°–µ—Ä–¥—Ü–µ —Å –±–∞–Ω—Ç–æ–º_remix_01k6n3czjze6paj61x9g5r7ab3.png"
      ],
      cheap_4: [
        "assets/images/–∫–µ–ø–∫–∞ –¥—É—Ä–æ–≤–∞ —Å–∏–Ω—è—è.png",
        "assets/images/–∫–æ–ª—å—Ü–æ —Ñ–∏–æ–ª–µ—Ç–æ–≤–æ–µ.png",
        "assets/images/—à–ª—è–ø–∞ –±–µ–ª–∞—è.png",
        "assets/images/20251003_1627_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –§–æ–Ω_remix_01k6n416bkeassbn7rx8a17bdt.png",
        "assets/images/20251003_1626_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –§–æ–Ω_remix_01k6n3y428frhrwqy0rqfwq9n5.png",
        "assets/images/20251003_1624_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3v1nbffkrc39mm720d2gm.png",
        "assets/images/20251003_1622_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3re47eearqtkwjk–∑ktpma.png",
        "assets/images/20251003_1621_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3p2hwf4fbk1r0rqbvdc5d.png",
        "assets/images/20251003_1620_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3k7yrey7864fgc944j33p.png",
        "assets/images/20251003_1618_–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω_remix_01k6n3fv8bej7813hnthjyags5.png",
        "assets/images/20251003_1616_–°–µ—Ä–¥—Ü–µ —Å –±–∞–Ω—Ç–æ–º_remix_01k6n3czjze6paj61x9g5r7ab3.png"
      ],

      nft_1:   ["","","","","","","","","","",""],
      nft_2:   ["","","","","","","","","","",""],
      nft_3:   ["","","","","","","","","","",""],
      nft_4:   ["","","","","","","","","","",""],

      exclusive_1: ["","","","","","","","","","",""],
      exclusive_2: ["","","","","","","","","","",""],
      exclusive_3: ["","","","","","","","","","",""],
      exclusive_4: ["","","","","","","","","","",""],

      standard_1:  ["","","","","","","","","","",""],
      standard_2:  ["","","","","","","","","","",""],
      standard_3:  ["","","","","","","","","","",""],
      standard_4:  ["","","","","","","","","","",""],

      gold_1:      ["","","","","","","","","","",""],
      gold_2:      ["","","","","","","","","","",""],
      gold_3:      ["","","","","","","","","","",""],
      gold_4:      ["","","","","","","","","","",""],

      allornothing_1: ["","","","","","","","","","",""],
      allornothing_2: ["","","","","","","","","","",""],
      allornothing_3: ["","","","","","","","","","",""],
      allornothing_4: ["","","","","","","","","","",""],

      expensive_1: ["","","","","","","","","","",""],
      expensive_2: ["","","","","","","","","","",""],
      expensive_3: ["","","","","","","","","","",""],
      expensive_4: ["","","","","","","","","","",""],
    };

    /* ===================== –û–ë–õ–û–ñ–ö–ò –°–ê–ú–ò–• –ö–ï–ô–°–û–í (–∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–∞ –ø–ª–∏—Ç–∫–µ) ===================== */
    const CASE_THUMBS = {
      free:     ["","assets/images/case.png","",""],
      cheap:    ["","","",""],
      nft:      ["","","",""],
      exclusive:["","","",""],
      standard: ["","","",""],
      gold:     ["","","",""],
      allornothing:["","","",""],
      expensive:["","","",""],
    };

    const FALLBACK_IMG = "https://via.placeholder.com/512?text=%F0%9F%8E%81";

    /* ====== –ò–∫–æ–Ω–∫–∏ –¥–ª—è —Ü–µ–Ω –ø–æ–¥ –ª—É—Ç–æ–º ====== */
    const STAR_ICON = "assets/images/–∑–≤–µ–∑–¥–∞.png";
    const TON_ICON  = "assets/images/—Ç–æ–Ω.png";

    /* ====== –¶–ï–ù–´/–¢–ï–ö–°–¢–´ –ª—É—Ç–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –î–ï–®–Å–í–´–• –∫–µ–π—Å–æ–≤ ====== */
    const LOOT_META = {
      cheap_1: [
        { title: "Durov's Cap Dipper", stars: 174000, ton: 870 },
        { title: "Item #2", stars: 1200, ton: 15 },
        { title: "Item #3", stars: 900,  ton: 9  },
        { title: "Item #4", stars: 500,  ton: 5  },
        { title: "Item #5", stars: 300,  ton: 3  },
        { title: "Item #6", stars: 200,  ton: 2  },
        { title: "Item #7", stars: 150,  ton: 1  },
        { title: "Item #8", stars: 120,  ton: 1  },
        { title: "Item #9", stars: 100,  ton: 1  },
        { title: "Item #10",stars: 80,   ton: 1  },
        { title: "Item #11",stars: 50,   ton: 0  },
      ],
      cheap_2: [
        { title:"Item #1", stars:1000, ton:10 },
        { title:"Item #2", stars:900, ton:9 },
        { title:"Item #3", stars:800, ton:8 },
        { title:"Item #4", stars:700, ton:7 },
        { title:"Item #5", stars:600, ton:6 },
        { title:"Item #6", stars:500, ton:5 },
        { title:"Item #7", stars:400, ton:4 },
        { title:"Item #8", stars:300, ton:3 },
        { title:"Item #9", stars:200, ton:2 },
        { title:"Item #10",stars:150, ton:1 },
        { title:"Item #11",stars:100, ton:1 },
      ],
      cheap_3: [
        { title:"Item #1", stars:1100, ton:11 },
        { title:"Item #2", stars:1000, ton:10 },
        { title:"Item #3", stars:900,  ton:9  },
        { title:"Item #4", stars:800,  ton:8  },
        { title:"Item #5", stars:700,  ton:7  },
        { title:"Item #6", stars:600,  ton:6  },
        { title:"Item #7", stars:500,  ton:5  },
        { title:"Item #8", stars:400,  ton:4  },
        { title:"Item #9", stars:300,  ton:3  },
        { title:"Item #10",stars:200,  ton:2  },
        { title:"Item #11",stars:100,  ton:1  },
      ],
      cheap_4: [
        { title:"Item #1", stars:900, ton:9 },
        { title:"Item #2", stars:820, ton:8 },
        { title:"Item #3", stars:740, ton:7 },
        { title:"Item #4", stars:660, ton:6 },
        { title:"Item #5", stars:580, ton:5 },
        { title:"Item #6", stars:500, ton:5 },
        { title:"Item #7", stars:420, ton:4 },
        { title:"Item #8", stars:340, ton:3 },
        { title:"Item #9", stars:260, ton:2 },
        { title:"Item #10",stars:180, ton:2 },
        { title:"Item #11",stars:120, ton:1 },
      ],
    };

    // –†–∞–∑–¥–µ–ª—ã
    const sections = [
      { id:'free',        title:'–ë–ï–°–ü–õ–ê–¢–ù–´–ï –ö–ï–ô–°–´',  items:4, price:'–ë–ï–°–ü–õ–ê–¢–ù–û',
        descs:['–ë–æ–Ω—É—Å –∑–∞ –ø—Ä–æ–º–æ–∫–æ–¥','–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å','–ó–∞ –ø–æ–¥–ø–∏—Å–∫—É','–ó–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ'] },
      { id:'cheap',       title:'–î–ï–®–Å–í–´–ï –ö–ï–ô–°–´',     items:4, price:['5 ‚≠ê','10 ‚≠ê','12 ‚≠ê','15 ‚≠ê'] },
      { id:'nft',         title:'–¢–û–õ–¨–ö–û NFT-–ö–ï–ô–°–´',  items:4, price:['25 ‚≠ê','30 ‚≠ê','35 ‚≠ê','40 ‚≠ê'] },
      { id:'exclusive',   title:'–≠–ö–°–ö–õ–Æ–ó–ò–í–ù–´–ï –ö–ï–ô–°–´',items:4, price:['60 ‚≠ê','70 ‚≠ê','80 ‚≠ê','90 ‚≠ê'] },
      { id:'standard',    title:'–°–¢–ê–ù–î–ê–†–¢–ù–´–ï –ö–ï–ô–°–´', items:4, price:['20 ‚≠ê','25 ‚≠ê','28 ‚≠ê','35 ‚≠ê'] },
      { id:'gold',        title:'–ö–ï–ô–°–´ –ó–ê –ó–û–õ–û–¢–û',    items:4, price:['–ó–û–õ–û–¢–û','–ó–û–õ–û–¢–û','–ó–û–õ–û–¢–û','–ó–û–õ–û–¢–û'] },
      { id:'allornothing',title:'–í–°–Å –ò–õ–ò –ù–ò–ß–ï–ì–û –ö–ï–ô–°–´',items:4,price:['50 ‚≠ê','75 ‚≠ê','100 ‚≠ê','150 ‚≠ê'] },
      { id:'expensive',   title:'–î–û–†–û–ì–ò–ï –ö–ï–ô–°–´',     items:4, price:['200 ‚≠ê','250 ‚≠ê','300 ‚≠ê','400 ‚≠ê'] },
    ];

    // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞
    const chipbar = document.getElementById('chipbar');
    const content = document.getElementById('content');

    sections.forEach(sec=>{
      const chip = document.createElement('div');
      chip.className = 'chip';
      chip.dataset.target = `#sec-${sec.id}`;
      chip.textContent = sec.title.replace(' –ö–ï–ô–°–´','');
      chipbar.appendChild(chip);

      const h2 = document.createElement('h2');
      h2.className = 'section';
      h2.id = `sec-${sec.id}`;
      h2.textContent = sec.title;
      content.appendChild(h2);

      const grid = document.createElement('div');
      grid.className = 'grid';

      for(let i=0;i<sec.items;i++){
        const thumbUrl = (CASE_THUMBS[sec.id] && CASE_THUMBS[sec.id][i]) || "";
        const thumbHTML = thumbUrl ? `<img src="${thumbUrl}" alt="–û–±–ª–æ–∂–∫–∞ –∫–µ–π—Å–∞ #${i+1}">` : `–ó–∞–≥–ª—É—à–∫–∞`;

        const card = document.createElement('div');
        card.className='card';
        card.innerHTML = `
          <div class="inner">
            <div class="thumb">${thumbHTML}</div>
            <div class="name">${sec.title.split(' ')[0]} –ö–µ–π—Å #${i+1}</div>
            <div class="desc">${(sec.descs && sec.descs[i]) || '–ù–µ–æ–Ω–æ–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è'}</div>
            <div class="price">${Array.isArray(sec.price)? sec.price[i] : sec.price}</div>
          </div>`;

        if (sec.id !== 'free') {
          const setId = `${sec.id}_${i+1}`;
          card.addEventListener('click', ()=> openDetail({
            title:`${sec.title} ‚Äî –ö–µ–π—Å #${i+1}`,
            price: Array.isArray(sec.price)? sec.price[i] : sec.price,
            setId
          }));
        }
        grid.appendChild(card);
      }
      content.appendChild(grid);
    });

    // –ß–∏–ø—ã
    const chips = Array.from(chipbar.querySelectorAll('.chip'));
    chipbar.addEventListener('click', e=>{
      const chip = e.target.closest('.chip'); if(!chip) return;
      setActiveChip(chip);
      const sel = chip.dataset.target;
      if(!sel || sel==="#top"){ window.scrollTo({top:0,behavior:'smooth'}); return; }
      document.querySelector(sel)?.scrollIntoView({behavior:'smooth', block:'start'});
    });
    function setActiveChip(ch){ chips.forEach(c=>c.classList.remove('active')); ch.classList.add('active'); }
    const mapTargetToChip = new Map([['#top', chipbar.querySelector('.chip.active')], ...chips.map(c=>[c.dataset.target,c])]);
    const sectionEls = sections.map(s=>document.getElementById(`sec-${s.id}`));
    const io = new IntersectionObserver((entries)=>{
      let best=null,ratio=0;
      for(const e of entries){ if(e.isIntersecting && e.intersectionRatio>ratio){best=e.target;ratio=e.intersectionRatio;} }
      if(best){ const ch = mapTargetToChip.get('#'+best.id); ch && setActiveChip(ch); }
      if(window.scrollY<10){ setActiveChip(mapTargetToChip.get('#top')); }
    }, {root:null, rootMargin:'-130px 0px -60% 0px', threshold:[0.2,0.4,0.6,0.8]});
    sectionEls.forEach(s=>io.observe(s));

    // –ö–Ω–æ–ø–∫–∞ –≤–≤–µ—Ä—Ö
    const backTop = document.getElementById('backTop');
    const toggleBackTop = ()=> backTop.classList.toggle('show', window.scrollY>2);
    window.addEventListener('scroll', toggleBackTop, {passive:true});
    backTop.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));
    toggleBackTop();

    // DETAIL VIEW
    const detail   = document.getElementById('detail');
    const backBtn  = document.getElementById('backBtn');
    const dTitle   = document.getElementById('detailTitle');
    const dPrice   = document.getElementById('detailPrice');
    const dThumb   = document.getElementById('detailThumb');
    const lootGrid = document.getElementById('lootGrid');
    const demoToggle = document.getElementById('demoToggle');
    const qtyWrap    = document.getElementById('qtyWrap');

    function renderLoot(images, meta){
      lootGrid.innerHTML = "";
      const list = (images && images.length) ? images.slice(0,11) : Array.from({length:11}, ()=>null);

      list.forEach((src, idx)=>{
        const cell = document.createElement('div');
        cell.className = 'loot';

        if (src){
          const img = document.createElement('img');
          img.src = src;
          img.alt = `–ü—Ä–µ–¥–º–µ—Ç ${idx+1}`;
          img.loading = "lazy";
          img.onerror = () => img.src = FALLBACK_IMG;
          cell.appendChild(img);
        } else {
          const dummy = document.createElement('div');
          dummy.style.position='absolute'; dummy.style.inset='0';
          dummy.style.display='grid'; dummy.style.placeItems='center';
          dummy.textContent='–ó–∞–≥–ª—É—à–∫–∞';
          cell.appendChild(dummy);
        }

        if (meta && meta[idx]){
          const m = meta[idx];

          const metaBox = document.createElement('div');
          metaBox.className = 'meta';

          if (m.title){
            const title = document.createElement('div');
            title.className = 'title';
            title.textContent = m.title;
            metaBox.appendChild(title);
          }

          const prices = document.createElement('div');
          prices.className = 'prices';

          if (typeof m.stars === 'number'){
            const row1 = document.createElement('div');
            row1.className = 'price-row';
            row1.innerHTML = `<img src="${STAR_ICON}" alt="‚≠ê"> ${m.stars.toLocaleString('ru-RU')}`;
            prices.appendChild(row1);
          }
          if (typeof m.ton === 'number'){
            const row2 = document.createElement('div');
            row2.className = 'price-row';
            row2.innerHTML = `<img src="${TON_ICON}" alt="üíé"> ${m.ton.toLocaleString('ru-RU')}`;
            prices.appendChild(row2);
          }

          metaBox.appendChild(prices);
          cell.appendChild(metaBox);
        }

        lootGrid.appendChild(cell);
      });
    }

    function openDetail({title, price, setId}) {
      dTitle.textContent = title;
      dPrice.textContent = String(price || '‚Äî');
      dThumb.textContent = '–ó–∞–≥–ª—É—à–∫–∞';

      const images = LOOT_SETS[setId] || null;
      const meta   = setId.startsWith('cheap_') ? (LOOT_META[setId] || null) : null;

      renderLoot(images, meta);
      detail.classList.add('show');
      detail.scrollTop = 0;
    }
    backBtn.addEventListener('click', ()=> detail.classList.remove('show'));

    demoToggle.addEventListener('click', ()=>{
      demoToggle.classList.toggle('active');
      demoToggle.setAttribute('aria-checked', demoToggle.classList.contains('active') ? 'true' : 'false');
    });
    qtyWrap.addEventListener('click', e=>{
      const q = e.target.closest('.q'); if(!q) return;
      qtyWrap.querySelectorAll('.q').forEach(el=>el.classList.remove('active'));
      q.classList.add('active');
    });

    // Telegram WebApp: –Ω–∏–∫ + –∞–≤–∞—Ç–∞—Ä
    (()=> {
      const tg = window.Telegram && window.Telegram.WebApp;
      const avatarImg = document.getElementById('userAvatar');
      const fallback  = document.getElementById('avatarFallback');
      const nameEl    = document.getElementById('userName');

      if(!tg) return;
      tg.ready(); tg.expand();

      const u = tg.initDataUnsafe && tg.initDataUnsafe.user;
      if(!u) return;

      const display = u.username ? '@' + u.username : [u.first_name||'', u.last_name||''].join(' ').trim() || 'GLITCH DROP';
      nameEl.textContent = display;
      nameEl.setAttribute('data-text', display.replaceAll(' ', '\u00A0'));

      if (u.photo_url){
        avatarImg.src = u.photo_url;
        avatarImg.classList.remove('hidden');
        fallback.style.display = 'none';
      }
    })();
  </script>
</body>
</html>
